spack:
  # Note: we're hoping to move the os definitions list into an include,
  # but not luck as of yet.
  definitions:
  - oses: [os=rhel7]
    when: os == 'rhel7'
  - compilers: [gcc@9.3.0]
    when: os == 'rhel7'
  - oses: [os=centos7]
    when: os == 'centos7'
  - compilers: [gcc@9.3.0]
    when: os == 'centos7'
  - oses: [os=centos8]
    when: os == 'centos8'
  - compilers: [gcc@8.3.1]
    when: os == 'centos8'
  - oses: [os=ubuntu18.04]
    when: os == 'ubuntu18.04'
  - compilers: [gcc@7.5.0]
    when: os == 'ubuntu18.04'
  - oses: [os=ubuntu20.04]
    when: os == 'ubuntu20.04'
  - compilers: [gcc@9.3.0]
    when: os == 'ubuntu20.04'
  - oses: [os=ubuntu20.10]
    when: os == 'ubuntu20.10'
  - compilers: [gcc@10.2.0]
    when: os == 'ubuntu20.10'
  - packages:
    - zlib
  specs:
  # Note: this seems to require two steps:
  # first concretizing with only the compilers until installed,
  # then concretizing with eveything after compilers are available.
  - matrix:
    - [$compilers]
    - [$oses]
#  - matrix:
#    - [$packages]
#    - [$%compilers]
#    - [$oses]
  packages:
    all:
      compiler: []
      target: [x86_64]
      buildable: true
      version: []
      providers: {}
      paths: {}
      modules: {}
  concretization: together
  # Note: views are not currently working with the {os} projection
  view: false
#  view:
#    default:
#      root: /cvmfs/eic.opensciencegrid.org/views/test
#      projections:
#        all: /{os}/

